<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>RNN - Many-to-many bidirectional | Chan`s Jupyter</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="RNN - Many-to-many bidirectional" />
<meta name="author" content="Chanseok Kang" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In this post, We will extend the many-to-many RNN model with bidirectional version. And it will show the simple implementation in tensorflow." />
<meta property="og:description" content="In this post, We will extend the many-to-many RNN model with bidirectional version. And it will show the simple implementation in tensorflow." />
<link rel="canonical" href="https://goodboychan.github.io/python/deep_learning/tensorflow-keras/2020/12/10/01-RNN-Many-to-many-bidirectional.html" />
<meta property="og:url" content="https://goodboychan.github.io/python/deep_learning/tensorflow-keras/2020/12/10/01-RNN-Many-to-many-bidirectional.html" />
<meta property="og:site_name" content="Chan`s Jupyter" />
<meta property="og:image" content="https://goodboychan.github.io/images/rnn_bidirectional.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-12-10T00:00:00-06:00" />
<script type="application/ld+json">
{"url":"https://goodboychan.github.io/python/deep_learning/tensorflow-keras/2020/12/10/01-RNN-Many-to-many-bidirectional.html","headline":"RNN - Many-to-many bidirectional","dateModified":"2020-12-10T00:00:00-06:00","datePublished":"2020-12-10T00:00:00-06:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://goodboychan.github.io/python/deep_learning/tensorflow-keras/2020/12/10/01-RNN-Many-to-many-bidirectional.html"},"image":"https://goodboychan.github.io/images/rnn_bidirectional.png","author":{"@type":"Person","name":"Chanseok Kang"},"description":"In this post, We will extend the many-to-many RNN model with bidirectional version. And it will show the simple implementation in tensorflow.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://goodboychan.github.io/feed.xml" title="Chan`s Jupyter" /><!-- the google_analytics_id gets auto inserted from the config file -->



<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-33905785-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-33905785-1');
</script>


<link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>

<script data-ad-client="ca-pub-6747875619665490" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Chan`s Jupyter</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About Me</a><a class="page-link" href="/book/">Book</a><a class="page-link" href="/search/">Search</a><a class="page-link" href="/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">RNN - Many-to-many bidirectional</h1><p class="page-description">In this post, We will extend the many-to-many RNN model with bidirectional version. And it will show the simple implementation in tensorflow.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-12-10T00:00:00-06:00" itemprop="datePublished">
        Dec 10, 2020
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Chanseok Kang</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      6 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/categories/#Python">Python</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#Deep_Learning">Deep_Learning</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#Tensorflow-Keras">Tensorflow-Keras</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-justify-center">
          <div class="px-2">

    <a href="https://github.com/goodboychan/goodboychan.github.io/tree/main/_notebooks/2020-12-10-01-RNN-Many-to-many-bidirectional.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/goodboychan/goodboychan.github.io/main?filepath=_notebooks%2F2020-12-10-01-RNN-Many-to-many-bidirectional.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/goodboychan/goodboychan.github.io/blob/main/_notebooks/2020-12-10-01-RNN-Many-to-many-bidirectional.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://deepnote.com/launch?url=https%3A%2F%2Fgithub.com%2Fgoodboychan%2Fgoodboychan.github.io%2Fblob%2Fmain%2F_notebooks%2F2020-12-10-01-RNN-Many-to-many-bidirectional.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/deepnote.svg" alt="Launch in Deepnote"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#What-is-"bidirectional"?">What is &quot;bidirectional&quot;? </a></li>
<li class="toc-entry toc-h2"><a href="#Example---Part-of-Speech-tagging">Example - Part-of-Speech tagging </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Prepare-dataset">Prepare dataset </a></li>
<li class="toc-entry toc-h3"><a href="#Preprocess-data">Preprocess data </a></li>
<li class="toc-entry toc-h3"><a href="#Model-implementation">Model implementation </a></li>
<li class="toc-entry toc-h3"><a href="#Model-training">Model training </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Summary">Summary </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-12-10-01-RNN-Many-to-many-bidirectional.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'Tensorflow: </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">__version__</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">'figure.figsize'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">'font'</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Tensorflow: 2.3.1
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash">
    <svg class="octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z"></path></svg>
    <strong>Note: </strong>There may some errors while using rnn layer in tensorflow 2.1.x. Usually, it will show the debug message like <code>CUDNN_STATUS_INTERNAL_ERROR</code>. See the details from <a href="https://github.com/tensorflow/tensorflow/issues/24496">here</a>. To prevent this, we need to set gpu configuration.
</div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gpus</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">experimental</span><span class="o">.</span><span class="n">list_physical_devices</span><span class="p">(</span><span class="s1">'GPU'</span><span class="p">)</span>
<span class="k">for</span> <span class="n">gpu</span> <span class="ow">in</span> <span class="n">gpus</span><span class="p">:</span>
    <span class="n">tf</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">experimental</span><span class="o">.</span><span class="n">set_memory_growth</span><span class="p">(</span><span class="n">gpu</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id='What-is-"bidirectional"?'>
<a class="anchor" href="#What-is-" bidirectional aria-hidden="true"><span class="octicon octicon-link"></span></a>What is "bidirectional"?<a class="anchor-link" href="#What-is-%22bidirectional%22?"> </a>
</h2>
<p><img src="/images/copied_from_nb/image/rnn_many-to-many-bidirectional.png" alt="rnn-bidirectional"></p>
<p>In previous post, we learned (basic) many-to-many rnn model, and implemented it for Part-of-Speech (POS) Tagging.</p>
<p>As we already know, the input is sequential data and hidden node is connected sequentially. That is, information contained in each node may be different. For example, assume that first token is consumed in first hidden node, and the information (maybe state information) will be transfered to the next hidden node, and so on. This process is repeated, and at last, the last hidden node will containe lots of information compared with previous node's. In that case, there is imbalance in the amount of information seen by the hidden states at different time steps.</p>
<p>So how can we prevent this? One approach is to add another hidden layer for information balance. So the information obtained from last token will be propagated to first hidden node. As a result, there are two kinds of hidden layer: the forward-pass, and the backward-pass. That's why we call this kind of model to <strong>"Bidirectional"</strong>.</p>
<p><img src="/images/copied_from_nb/image/rnn_bidirectional.png" alt="rnn-bidirectional2"></p>
<p>The detailed representation is like this. There are two hidden layers, forward rnn and backward rnn. At each time step, the hidden node from forward rnn and the hidden node from backward rnn is concatenated. Then, it will multiply with weight of node, and adding the bias. After that, output is generated.</p>
<p>Since this model is also many-to-many rnn model, the sequence loss is used.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Example---Part-of-Speech-tagging">
<a class="anchor" href="#Example---Part-of-Speech-tagging" aria-hidden="true"><span class="octicon octicon-link"></span></a>Example - Part-of-Speech tagging<a class="anchor-link" href="#Example---Part-of-Speech-tagging"> </a>
</h2>
<p>Like the previous example, we will implement the bidirectional model for POS tagging.</p>
<h3 id="Prepare-dataset">
<a class="anchor" href="#Prepare-dataset" aria-hidden="true"><span class="octicon octicon-link"></span></a>Prepare dataset<a class="anchor-link" href="#Prepare-dataset"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sentences</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">'I'</span><span class="p">,</span> <span class="s1">'feel'</span><span class="p">,</span> <span class="s1">'hungry'</span><span class="p">],</span>
             <span class="p">[</span><span class="s1">'tensorflow'</span><span class="p">,</span> <span class="s1">'is'</span><span class="p">,</span> <span class="s1">'very'</span><span class="p">,</span> <span class="s1">'difficult'</span><span class="p">],</span>
             <span class="p">[</span><span class="s1">'tensorflow'</span><span class="p">,</span> <span class="s1">'is'</span><span class="p">,</span> <span class="s1">'a'</span><span class="p">,</span> <span class="s1">'framework'</span><span class="p">,</span> <span class="s1">'for'</span><span class="p">,</span> <span class="s1">'deep'</span><span class="p">,</span> <span class="s1">'learning'</span><span class="p">],</span>
             <span class="p">[</span><span class="s1">'tensorflow'</span><span class="p">,</span> <span class="s1">'is'</span><span class="p">,</span> <span class="s1">'very'</span><span class="p">,</span> <span class="s1">'fast'</span><span class="p">,</span> <span class="s1">'changing'</span><span class="p">]]</span>

<span class="n">pos</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">'pronoun'</span><span class="p">,</span> <span class="s1">'verb'</span><span class="p">,</span> <span class="s1">'adjective'</span><span class="p">],</span> 
       <span class="p">[</span><span class="s1">'noun'</span><span class="p">,</span> <span class="s1">'verb'</span><span class="p">,</span> <span class="s1">'adverb'</span><span class="p">,</span> <span class="s1">'adjective'</span><span class="p">],</span>
       <span class="p">[</span><span class="s1">'noun'</span><span class="p">,</span> <span class="s1">'verb'</span><span class="p">,</span> <span class="s1">'determiner'</span><span class="p">,</span> <span class="s1">'noun'</span><span class="p">,</span> <span class="s1">'preposition'</span><span class="p">,</span> <span class="s1">'adjective'</span><span class="p">,</span> <span class="s1">'noun'</span><span class="p">],</span>
       <span class="p">[</span><span class="s1">'noun'</span><span class="p">,</span> <span class="s1">'verb'</span><span class="p">,</span> <span class="s1">'adverb'</span><span class="p">,</span> <span class="s1">'adjective'</span><span class="p">,</span> <span class="s1">'verb'</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Preprocess-data">
<a class="anchor" href="#Preprocess-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Preprocess data<a class="anchor-link" href="#Preprocess-data"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">word_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'&lt;pad&gt;'</span><span class="p">]</span> <span class="o">+</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">sentences</span><span class="p">,</span> <span class="p">[])))</span>
<span class="n">word2idx</span> <span class="o">=</span> <span class="p">{</span><span class="n">word</span><span class="p">:</span><span class="n">idx</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">word</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">word_list</span><span class="p">)}</span>
<span class="n">idx2word</span> <span class="o">=</span> <span class="p">{</span><span class="n">idx</span><span class="p">:</span><span class="n">word</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">word</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">word_list</span><span class="p">)}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">word2idx</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>{'&lt;pad&gt;': 0, 'I': 1, 'a': 2, 'changing': 3, 'deep': 4, 'difficult': 5, 'fast': 6, 'feel': 7, 'for': 8, 'framework': 9, 'hungry': 10, 'is': 11, 'learning': 12, 'tensorflow': 13, 'very': 14}
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">idx2word</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>{0: '&lt;pad&gt;', 1: 'I', 2: 'a', 3: 'changing', 4: 'deep', 5: 'difficult', 6: 'fast', 7: 'feel', 8: 'for', 9: 'framework', 10: 'hungry', 11: 'is', 12: 'learning', 13: 'tensorflow', 14: 'very'}
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pos_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'&lt;pad&gt;'</span><span class="p">]</span> <span class="o">+</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="p">[])))</span>
<span class="n">pos2idx</span> <span class="o">=</span> <span class="p">{</span><span class="n">pos</span><span class="p">:</span><span class="n">idx</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">pos</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pos_list</span><span class="p">)}</span>
<span class="n">idx2pos</span> <span class="o">=</span> <span class="p">{</span><span class="n">idx</span><span class="p">:</span><span class="n">pos</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">pos</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pos_list</span><span class="p">)}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">pos2idx</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>{'&lt;pad&gt;': 0, 'adjective': 1, 'adverb': 2, 'determiner': 3, 'noun': 4, 'preposition': 5, 'pronoun': 6, 'verb': 7}
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">idx2pos</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>{0: '&lt;pad&gt;', 1: 'adjective', 2: 'adverb', 3: 'determiner', 4: 'noun', 5: 'preposition', 6: 'pronoun', 7: 'verb'}
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Same as before, we build the token/POS dictionary. And we need to consider padding token. So we make a masking vector for filtering padding token.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">sentence</span><span class="p">:</span> <span class="p">[</span><span class="n">word2idx</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">token</span><span class="p">)</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">sentence</span><span class="p">],</span> <span class="n">sentences</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">sentence</span><span class="p">:</span> <span class="p">[</span><span class="n">pos2idx</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">token</span><span class="p">)</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">sentence</span><span class="p">],</span> <span class="n">pos</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[[1, 7, 10], [13, 11, 14, 5], [13, 11, 2, 9, 8, 4, 12], [13, 11, 14, 6, 3]]
[[6, 7, 1], [4, 7, 2, 1], [4, 7, 3, 4, 5, 1, 4], [4, 7, 2, 1, 7]]
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">tensorflow.keras.preprocessing.sequence</span> <span class="kn">import</span> <span class="n">pad_sequences</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">pad_sequences</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">maxlen</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">'post'</span><span class="p">)</span>
<span class="n">X_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">X_len</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">((</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">sentence</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">sentence</span><span class="p">),</span> <span class="n">sentences</span><span class="p">))),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_mask</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_len</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[[ 1  7 10  0  0  0  0  0  0  0]
 [13 11 14  5  0  0  0  0  0  0]
 [13 11  2  9  8  4 12  0  0  0]
 [13 11 14  6  3  0  0  0  0  0]]
[[1. 1. 1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 1. 1. 1. 0. 0. 0. 0. 0. 0.]
 [1. 1. 1. 1. 1. 1. 1. 0. 0. 0.]
 [1. 1. 1. 1. 1. 0. 0. 0. 0. 0.]]
[3. 4. 7. 5.]
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">pad_sequences</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">maxlen</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">'post'</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[[6 7 1 0 0 0 0 0 0 0]
 [4 7 2 1 0 0 0 0 0 0]
 [4 7 3 4 5 1 4 0 0 0]
 [4 7 2 1 7 0 0 0 0 0]]
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_ds</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Dataset</span><span class="o">.</span><span class="n">from_tensor_slices</span><span class="p">((</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">X_len</span><span class="p">))</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">buffer_size</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">train_ds</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;BatchDataset shapes: ((None, 10), (None, 10), (None,)), types: (tf.int32, tf.int32, tf.float32)&gt;
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Model-implementation">
<a class="anchor" href="#Model-implementation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Model implementation<a class="anchor-link" href="#Model-implementation"> </a>
</h3>
<p>Here, we will use new kind of layer, <code>Bidirectional</code>. Technically, it is not operational layer, like <code>Dense</code>, <code>Conv2D</code>, <code>Flatten</code>, and so on. It is wrapper for rnn layers. So it requires base rnn layer, like <code>SimpleRNN</code>, <code>LSTM</code>, and <code>GRU</code>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">InputLayer</span><span class="p">,</span> <span class="n">Embedding</span><span class="p">,</span> <span class="n">Bidirectional</span><span class="p">,</span> <span class="n">SimpleRNN</span><span class="p">,</span> <span class="n">TimeDistributed</span><span class="p">,</span> <span class="n">Dense</span>


<span class="n">num_classes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pos2idx</span><span class="p">)</span>

<span class="n">input_dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">word2idx</span><span class="p">)</span>
<span class="n">output_dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">word2idx</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">([</span>
    <span class="n">InputLayer</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="p">)),</span>
    <span class="n">Embedding</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="n">input_dim</span><span class="p">,</span> <span class="n">output_dim</span><span class="o">=</span><span class="n">output_dim</span><span class="p">,</span> <span class="n">mask_zero</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
              <span class="n">trainable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">input_length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
              <span class="n">embeddings_initializer</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">random_normal</span><span class="p">()),</span>
    <span class="n">Bidirectional</span><span class="p">(</span><span class="n">SimpleRNN</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">return_sequences</span><span class="o">=</span><span class="kc">True</span><span class="p">)),</span>
    <span class="n">TimeDistributed</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="n">num_classes</span><span class="p">))</span>
<span class="p">])</span>

<span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Model: "sequential_2"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_2 (Embedding)      (None, 10, 15)            225       
_________________________________________________________________
bidirectional_2 (Bidirection (None, 10, 20)            520       
_________________________________________________________________
time_distributed_2 (TimeDist (None, 10, 8)             168       
=================================================================
Total params: 913
Trainable params: 688
Non-trainable params: 225
_________________________________________________________________
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Model-training">
<a class="anchor" href="#Model-training" aria-hidden="true"><span class="octicon octicon-link"></span></a>Model training<a class="anchor-link" href="#Model-training"> </a>
</h3>
<p>After that, we can define loss function (same as previous example in many-to-many post) and optimizer (we will use Adam optimizer)</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">loss_fn</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x_len</span><span class="p">,</span> <span class="n">max_sequence</span><span class="p">):</span>
    <span class="n">masking</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">sequence_mask</span><span class="p">(</span><span class="n">x_len</span><span class="p">,</span> <span class="n">maxlen</span><span class="o">=</span><span class="n">max_sequence</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="n">sequence_loss</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">sparse_categorical_crossentropy</span><span class="p">(</span>
        <span class="n">y_true</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">from_logits</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">*</span> <span class="n">masking</span>
    <span class="n">sequence_loss</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_mean</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">reduce_sum</span><span class="p">(</span><span class="n">sequence_loss</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">x_len</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sequence_loss</span>

<span class="n">optimizer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tr_loss_hist</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">):</span>
    <span class="n">avg_tr_loss</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">tr_step</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">x_mb</span><span class="p">,</span> <span class="n">y_mb</span><span class="p">,</span> <span class="n">x_mb_len</span> <span class="ow">in</span> <span class="n">train_ds</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">GradientTape</span><span class="p">()</span> <span class="k">as</span> <span class="n">tape</span><span class="p">:</span>
            <span class="n">tr_loss</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">x_mb</span><span class="p">,</span> <span class="n">y_mb</span><span class="p">,</span> <span class="n">x_mb_len</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="n">grads</span> <span class="o">=</span> <span class="n">tape</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">tr_loss</span><span class="p">,</span> <span class="n">sources</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">trainable_variables</span><span class="p">)</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">apply_gradients</span><span class="p">(</span><span class="n">grads_and_vars</span><span class="o">=</span><span class="nb">zip</span><span class="p">(</span><span class="n">grads</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">trainable_variables</span><span class="p">))</span>
        <span class="n">avg_tr_loss</span> <span class="o">+=</span> <span class="n">tr_loss</span>
        <span class="n">tr_step</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">avg_tr_loss</span> <span class="o">/=</span> <span class="n">tr_step</span>
    <span class="n">tr_loss_hist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">avg_tr_loss</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="n">e</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">5</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Epoch: </span><span class="si">{:3}</span><span class="s1">, tr_loss: </span><span class="si">{:.3f}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">avg_tr_loss</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch:   5, tr_loss: 0.256
Epoch:  10, tr_loss: 0.016
Epoch:  15, tr_loss: 0.002
Epoch:  20, tr_loss: 0.001
Epoch:  25, tr_loss: 0.001
Epoch:  30, tr_loss: 0.000
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Compared with the result from basic many-to-many model, training loss is slightly decreased.
Then, let's check the performance.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">X_mask</span>

<span class="n">y_pred</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[6., 7., 1., 0., 0., 0., 0., 0., 0., 0.],
       [4., 7., 2., 1., 0., 0., 0., 0., 0., 0.],
       [4., 7., 3., 4., 5., 1., 4., 0., 0., 0.],
       [4., 7., 2., 1., 7., 0., 0., 0., 0., 0.]])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>

<span class="n">y_pred_pos</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="p">[</span><span class="n">idx2pos</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">elm</span><span class="p">)</span> <span class="k">for</span> <span class="n">elm</span> <span class="ow">in</span> <span class="n">row</span><span class="p">],</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>

<span class="n">pprint</span><span class="p">(</span><span class="n">y_pred_pos</span><span class="p">)</span>

<span class="n">pprint</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[['pronoun',
  'verb',
  'adjective',
  '&lt;pad&gt;',
  '&lt;pad&gt;',
  '&lt;pad&gt;',
  '&lt;pad&gt;',
  '&lt;pad&gt;',
  '&lt;pad&gt;',
  '&lt;pad&gt;'],
 ['noun',
  'verb',
  'adverb',
  'adjective',
  '&lt;pad&gt;',
  '&lt;pad&gt;',
  '&lt;pad&gt;',
  '&lt;pad&gt;',
  '&lt;pad&gt;',
  '&lt;pad&gt;'],
 ['noun',
  'verb',
  'determiner',
  'noun',
  'preposition',
  'adjective',
  'noun',
  '&lt;pad&gt;',
  '&lt;pad&gt;',
  '&lt;pad&gt;'],
 ['noun',
  'verb',
  'adverb',
  'adjective',
  'verb',
  '&lt;pad&gt;',
  '&lt;pad&gt;',
  '&lt;pad&gt;',
  '&lt;pad&gt;',
  '&lt;pad&gt;']]
[['pronoun', 'verb', 'adjective'],
 ['noun', 'verb', 'adverb', 'adjective'],
 ['noun', 'verb', 'determiner', 'noun', 'preposition', 'adjective', 'noun'],
 ['noun', 'verb', 'adverb', 'adjective', 'verb']]
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tr_loss_hist</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Training loss for many-to-many bidirectional model'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Summary">
<a class="anchor" href="#Summary" aria-hidden="true"><span class="octicon octicon-link"></span></a>Summary<a class="anchor-link" href="#Summary"> </a>
</h2>
<p>Through this post, in order to handle the information imbalance while processing sequence data, another rnn layer is added. So the information is transfered in 2 ways (forward-pass and backward-pass).</p>
<p>we try to implement this kind of bidirectional many-to-many model with tensorflow, and train it for POS tagging. Interestingly, the training speed is slightly faster than base model, and it also show 100% accuracy on training dataset.</p>

</div>
</div>
</div>
</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="goodboychan/goodboychan.github.io"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/python/deep_learning/tensorflow-keras/2020/12/10/01-RNN-Many-to-many-bidirectional.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>An easy to use blogging platform with support for Jupyter Notebooks.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/goodboychan" target="_blank" title="goodboychan"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://www.linkedin.com/in/chanseokk" target="_blank" title="chanseokk"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg></a></li><li><a rel="me" href="https://twitter.com/fastdotai" target="_blank" title="fastdotai"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
