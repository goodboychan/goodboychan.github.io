<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Kaggle competitions process | Chan`s Jupyter</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Kaggle competitions process" />
<meta name="author" content="Chanseok Kang" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In this first chapter, you will get exposure to the Kaggle competition process. You will train a model and prepare a csv file ready for submission. You will learn the difference between Public and Private test splits, and how to prevent overfitting. This is the Summary of lecture “Winning a Kaggle Competition in Python”, via datacamp." />
<meta property="og:description" content="In this first chapter, you will get exposure to the Kaggle competition process. You will train a model and prepare a csv file ready for submission. You will learn the difference between Public and Private test splits, and how to prevent overfitting. This is the Summary of lecture “Winning a Kaggle Competition in Python”, via datacamp." />
<link rel="canonical" href="https://goodboychan.github.io/chans_jupyter/python/datacamp/kaggle/machine_learning/2020/08/12/01-Kaggle-competitions-process.html" />
<meta property="og:url" content="https://goodboychan.github.io/chans_jupyter/python/datacamp/kaggle/machine_learning/2020/08/12/01-Kaggle-competitions-process.html" />
<meta property="og:site_name" content="Chan`s Jupyter" />
<meta property="og:image" content="https://goodboychan.github.io/chans_jupyter/images/Kaggle_logo.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-08-12T00:00:00-05:00" />
<script type="application/ld+json">
{"url":"https://goodboychan.github.io/chans_jupyter/python/datacamp/kaggle/machine_learning/2020/08/12/01-Kaggle-competitions-process.html","@type":"BlogPosting","headline":"Kaggle competitions process","dateModified":"2020-08-12T00:00:00-05:00","datePublished":"2020-08-12T00:00:00-05:00","image":"https://goodboychan.github.io/chans_jupyter/images/Kaggle_logo.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://goodboychan.github.io/chans_jupyter/python/datacamp/kaggle/machine_learning/2020/08/12/01-Kaggle-competitions-process.html"},"author":{"@type":"Person","name":"Chanseok Kang"},"description":"In this first chapter, you will get exposure to the Kaggle competition process. You will train a model and prepare a csv file ready for submission. You will learn the difference between Public and Private test splits, and how to prevent overfitting. This is the Summary of lecture “Winning a Kaggle Competition in Python”, via datacamp.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/chans_jupyter/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://goodboychan.github.io/chans_jupyter/feed.xml" title="Chan`s Jupyter" /><!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-33905785-1','auto');ga('require','displayfeatures');ga('send','pageview');</script>

<link rel="shortcut icon" type="image/x-icon" href="/chans_jupyter/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/chans_jupyter/">Chan`s Jupyter</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/chans_jupyter/about/">About Me</a><a class="page-link" href="/chans_jupyter/search/">Search</a><a class="page-link" href="/chans_jupyter/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Kaggle competitions process</h1><p class="page-description">In this first chapter, you will get exposure to the Kaggle competition process. You will train a model and prepare a csv file ready for submission. You will learn the difference between Public and Private test splits, and how to prevent overfitting. This is the Summary of lecture "Winning a Kaggle Competition in Python", via datacamp.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-08-12T00:00:00-05:00" itemprop="datePublished">
        Aug 12, 2020
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Chanseok Kang</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      5 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/chans_jupyter/categories/#Python">Python</a>
        &nbsp;
      
        <a class="category-tags-link" href="/chans_jupyter/categories/#Datacamp">Datacamp</a>
        &nbsp;
      
        <a class="category-tags-link" href="/chans_jupyter/categories/#Kaggle">Kaggle</a>
        &nbsp;
      
        <a class="category-tags-link" href="/chans_jupyter/categories/#Machine_Learning">Machine_Learning</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/goodboychan/chans_jupyter/tree/main/_notebooks/2020-08-12-01-Kaggle-competitions-process.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/chans_jupyter/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/goodboychan/chans_jupyter/main?filepath=_notebooks%2F2020-08-12-01-Kaggle-competitions-process.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/chans_jupyter/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/goodboychan/chans_jupyter/blob/main/_notebooks/2020-08-12-01-Kaggle-competitions-process.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/chans_jupyter/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>

        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#Competitions-overview">Competitions overview </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Explore-train-data">Explore train data </a></li>
<li class="toc-entry toc-h3"><a href="#Explore-test-data">Explore test data </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Prepare-your-first-submission">Prepare your first submission </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Determine-a-problem-type">Determine a problem type </a></li>
<li class="toc-entry toc-h3"><a href="#Train-a-simple-model">Train a simple model </a></li>
<li class="toc-entry toc-h3"><a href="#Prepare-a-submission">Prepare a submission </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Public-vs-Private-leaderboard">Public vs Private leaderboard </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Train-XGBoost-models">Train XGBoost models </a></li>
<li class="toc-entry toc-h3"><a href="#Explore-overfitting-XGBoost">Explore overfitting XGBoost </a></li>
</ul>
</li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-08-12-01-Kaggle-competitions-process.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Competitions-overview">
<a class="anchor" href="#Competitions-overview" aria-hidden="true"><span class="octicon octicon-link"></span></a>Competitions overview<a class="anchor-link" href="#Competitions-overview"> </a>
</h2>
<ul>
<li>Kaggle benefits<ul>
<li>Get practical experience on the real-world data</li>
<li>Develop portfolio projects</li>
<li>Meet a great Data Science community</li>
<li>Try new domain or model type</li>
<li>Keep up-to-date with the best performing methods</li>
</ul>
</li>
<li>Process
<img src="/chans_jupyter/images/copied_from_nb/image/competition_process.png" alt="process">
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Explore-train-data">
<a class="anchor" href="#Explore-train-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Explore train data<a class="anchor-link" href="#Explore-train-data"> </a>
</h3>
<p>You will work with another Kaggle competition called "Store Item Demand Forecasting Challenge". In this competition, you are given 5 years of store-item sales data, and asked to predict 3 months of sales for 50 different items in 10 different stores.</p>
<p>To begin, let's explore the train data for this competition. For the faster performance, you will work with a subset of the train data containing only a single month history.</p>
<p>Your initial goal is to read the input data and take the first look at it.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'./dataset/demand_forecasting_train_1_month.csv'</span><span class="p">)</span>

<span class="c1"># Look at the shape of the data</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Train shape:'</span><span class="p">,</span> <span class="n">train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1"># Look at the head() of the data</span>
<span class="n">train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Train shape: (15500, 5)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>date</th>
      <th>store</th>
      <th>item</th>
      <th>sales</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>100000</td>
      <td>2017-12-01</td>
      <td>1</td>
      <td>1</td>
      <td>19</td>
    </tr>
    <tr>
      <th>1</th>
      <td>100001</td>
      <td>2017-12-02</td>
      <td>1</td>
      <td>1</td>
      <td>16</td>
    </tr>
    <tr>
      <th>2</th>
      <td>100002</td>
      <td>2017-12-03</td>
      <td>1</td>
      <td>1</td>
      <td>31</td>
    </tr>
    <tr>
      <th>3</th>
      <td>100003</td>
      <td>2017-12-04</td>
      <td>1</td>
      <td>1</td>
      <td>7</td>
    </tr>
    <tr>
      <th>4</th>
      <td>100004</td>
      <td>2017-12-05</td>
      <td>1</td>
      <td>1</td>
      <td>20</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Explore-test-data">
<a class="anchor" href="#Explore-test-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Explore test data<a class="anchor-link" href="#Explore-test-data"> </a>
</h3>
<p>Having looked at the train data, let's explore the test data in the "Store Item Demand Forecasting Challenge". Remember, that the test dataset generally contains one column less than the train one.</p>
<p>This column, together with the output format, is presented in the sample submission file. Before making any progress in the competition, you should get familiar with the expected output.</p>
<p>That is why, let's look at the columns of the test dataset and compare it to the train columns. Additionally, let's explore the format of the sample submission.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'./dataset/demand_forecasting_test.csv'</span><span class="p">)</span>

<span class="c1"># Print train and test columns</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Train columns:'</span><span class="p">,</span> <span class="n">train</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Test columns:'</span><span class="p">,</span> <span class="n">test</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Train columns: ['id', 'date', 'store', 'item', 'sales']
Test columns: ['id', 'date', 'store', 'item']
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sample_submission</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'./dataset/sample_submission.csv'</span><span class="p">)</span>

<span class="c1"># Look at the head() of the sample submission</span>
<span class="n">sample_submission</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>sales</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>52</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>52</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>52</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>52</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>52</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The sample submission file consists of two columns: <code>id</code> of the observation and <code>sales</code> column for your predictions. Kaggle will evaluate your predictions on the true <code>sales</code> data for the corresponding <code>id</code>. So, it’s important to keep track of the predictions by <code>id</code> before submitting them.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Prepare-your-first-submission">
<a class="anchor" href="#Prepare-your-first-submission" aria-hidden="true"><span class="octicon octicon-link"></span></a>Prepare your first submission<a class="anchor-link" href="#Prepare-your-first-submission"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Determine-a-problem-type">
<a class="anchor" href="#Determine-a-problem-type" aria-hidden="true"><span class="octicon octicon-link"></span></a>Determine a problem type<a class="anchor-link" href="#Determine-a-problem-type"> </a>
</h3>
<p>You will keep working on the Store Item Demand Forecasting Challenge. Recall that you are given a history of store-item sales data, and asked to predict 3 months of the future sales.</p>
<p>Before building a model, you should determine the problem type you are addressing. The goal of this exercise is to look at the distribution of the target variable, and select the correct problem type you will be building a model for.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">train</span><span class="o">.</span><span class="n">sales</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'histogram of sales'</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Train-a-simple-model">
<a class="anchor" href="#Train-a-simple-model" aria-hidden="true"><span class="octicon octicon-link"></span></a>Train a simple model<a class="anchor-link" href="#Train-a-simple-model"> </a>
</h3>
<p>As you determined, you are dealing with a regression problem. So, now you're ready to build a model for a subsequent submission. But now, instead of building the simplest Linear Regression model as in the slides, let's build an out-of-box Random Forest model.</p>
<p>You will use the <code>RandomForestRegressor</code> class from the scikit-learn library.</p>
<p>Your objective is to train a Random Forest model with default parameters on the "store" and "item" features.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>

<span class="c1"># Create a Random Forest object</span>
<span class="n">rf</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">()</span>

<span class="c1"># Train a model</span>
<span class="n">rf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">train</span><span class="p">[[</span><span class="s1">'store'</span><span class="p">,</span> <span class="s1">'item'</span><span class="p">]],</span> <span class="n">y</span><span class="o">=</span><span class="n">train</span><span class="p">[</span><span class="s1">'sales'</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>RandomForestRegressor()</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Prepare-a-submission">
<a class="anchor" href="#Prepare-a-submission" aria-hidden="true"><span class="octicon octicon-link"></span></a>Prepare a submission<a class="anchor-link" href="#Prepare-a-submission"> </a>
</h3>
<p>You've already built a model on the training data from the Kaggle Store Item Demand Forecasting Challenge. Now, it's time to make predictions on the test data and create a submission file in the specified format.</p>
<p>Your goal is to read the test data, make predictions, and save these in the format specified in the "sample_submission.csv" file.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sample_submission</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>sales</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>52</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>52</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>52</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>52</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>52</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test</span><span class="p">[</span><span class="s1">'sales'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test</span><span class="p">[[</span><span class="s1">'store'</span><span class="p">,</span> <span class="s1">'item'</span><span class="p">]])</span>

<span class="c1"># Write test predictions using the sample_submission format</span>
<span class="n">test</span><span class="p">[[</span><span class="s1">'id'</span><span class="p">,</span> <span class="s1">'sales'</span><span class="p">]]</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">'kaggle_submission.csv'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>head kaggle_submission.csv
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>id,sales
0,17.143270686120914
1,17.143270686120914
2,17.143270686120914
3,17.143270686120914
4,17.143270686120914
5,17.143270686120914
6,17.143270686120914
7,17.143270686120914
8,17.143270686120914
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Public-vs-Private-leaderboard">
<a class="anchor" href="#Public-vs-Private-leaderboard" aria-hidden="true"><span class="octicon octicon-link"></span></a>Public vs Private leaderboard<a class="anchor-link" href="#Public-vs-Private-leaderboard"> </a>
</h2>
<ul>
<li>Competition metric</li>
</ul>
<table>
<thead>
<tr>
<th>Evaluation metric</th>
<th>Type of problem</th>
</tr>
</thead>
<tbody>
<tr>
<td>Area Under the ROC (AUC)</td>
<td>Classification</td>
</tr>
<tr>
<td>F1 score (F1)</td>
<td>Classification</td>
</tr>
<tr>
<td>Mean Log Loss (LogLoss)</td>
<td>Classification</td>
</tr>
<tr>
<td>Mean Absolute Error (MAE)</td>
<td>Regression</td>
</tr>
<tr>
<td>Mean Squared Erro (MSE)</td>
<td>Regression</td>
</tr>
<tr>
<td>Mean Average Precision at K (MAPK, MAP@K)</td>
<td>Ranking</td>
</tr>
</tbody>
</table>
<ul>
<li>Overfitting in kaggle
<img src="/chans_jupyter/images/copied_from_nb/image/overfitting_kaggle.png" alt="of">
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Train-XGBoost-models">
<a class="anchor" href="#Train-XGBoost-models" aria-hidden="true"><span class="octicon octicon-link"></span></a>Train XGBoost models<a class="anchor-link" href="#Train-XGBoost-models"> </a>
</h3>
<p>Every Machine Learning method could potentially overfit. You will see it on this example with XGBoost. Again, you are working with the Store Item Demand Forecasting Challenge.</p>
<p>Firstly, let's train multiple XGBoost models with different sets of hyperparameters using XGBoost's learning API. The single hyperparameter you will change is:</p>
<ul>
<li>
<code>max_depth</code> - maximum depth of a tree. Increasing this value will make the model more complex and more likely to overfit.</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">xgboost</span> <span class="k">as</span> <span class="nn">xgb</span>

<span class="c1"># Create DMatrix on train data</span>
<span class="n">dtrain</span> <span class="o">=</span> <span class="n">xgb</span><span class="o">.</span><span class="n">DMatrix</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">train</span><span class="p">[[</span><span class="s1">'store'</span><span class="p">,</span> <span class="s1">'item'</span><span class="p">]],</span>
                     <span class="n">label</span><span class="o">=</span><span class="n">train</span><span class="p">[</span><span class="s1">'sales'</span><span class="p">])</span>

<span class="c1"># Define xgboost parameters</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'objective'</span><span class="p">:</span> <span class="s1">'reg:squarederror'</span><span class="p">,</span>
          <span class="s1">'max_depth'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
          <span class="s1">'verbosity'</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>

<span class="c1"># Train xgboost model</span>
<span class="n">xg_depth_2</span> <span class="o">=</span> <span class="n">xgb</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">dtrain</span><span class="o">=</span><span class="n">dtrain</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'objective'</span><span class="p">:</span> <span class="s1">'reg:squarederror'</span><span class="p">,</span>
          <span class="s1">'max_depth'</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
          <span class="s1">'verbosity'</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>

<span class="c1"># Train xgboost model</span>
<span class="n">xg_depth_8</span> <span class="o">=</span> <span class="n">xgb</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">dtrain</span><span class="o">=</span><span class="n">dtrain</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'objective'</span><span class="p">:</span> <span class="s1">'reg:squarederror'</span><span class="p">,</span>
          <span class="s1">'max_depth'</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
          <span class="s1">'verbosity'</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>

<span class="c1"># Train xgboost model</span>
<span class="n">xg_depth_15</span> <span class="o">=</span> <span class="n">xgb</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">dtrain</span><span class="o">=</span><span class="n">dtrain</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Explore-overfitting-XGBoost">
<a class="anchor" href="#Explore-overfitting-XGBoost" aria-hidden="true"><span class="octicon octicon-link"></span></a>Explore overfitting XGBoost<a class="anchor-link" href="#Explore-overfitting-XGBoost"> </a>
</h3>
<p>Having trained 3 XGBoost models with different maximum depths, you will now evaluate their quality. For this purpose, you will measure the quality of each model on both the train data and the test data. As you know by now, the train data is the data models have been trained on. The test data is the next month sales data that models have never seen before.</p>
<p>The goal of this exercise is to determine whether any of the models trained is overfitting. To measure the quality of the models you will use Mean Squared Error (MSE). It's available in <code>sklearn.metrics</code> as <code>mean_squared_error()</code> function that takes two arguments: true values and predicted values.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>

<span class="n">dtrain</span> <span class="o">=</span> <span class="n">xgb</span><span class="o">.</span><span class="n">DMatrix</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">train</span><span class="p">[[</span><span class="s1">'store'</span><span class="p">,</span> <span class="s1">'item'</span><span class="p">]])</span>
<span class="n">dtest</span> <span class="o">=</span> <span class="n">xgb</span><span class="o">.</span><span class="n">DMatrix</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">test</span><span class="p">[[</span><span class="s1">'store'</span><span class="p">,</span> <span class="s1">'item'</span><span class="p">]])</span>

<span class="c1"># For each of 3 trained models</span>
<span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="p">[</span><span class="n">xg_depth_2</span><span class="p">,</span> <span class="n">xg_depth_8</span><span class="p">,</span> <span class="n">xg_depth_15</span><span class="p">]:</span>
    <span class="c1"># Make predictions</span>
    <span class="n">train_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">dtrain</span><span class="p">)</span>
    <span class="n">test_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">dtest</span><span class="p">)</span>
    
    <span class="c1"># Calculate metrics</span>
    <span class="n">mse_train</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s1">'sales'</span><span class="p">],</span> <span class="n">train_pred</span><span class="p">)</span>
    <span class="n">mse_test</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="s1">'sales'</span><span class="p">],</span> <span class="n">test_pred</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'MSE Train: </span><span class="si">{:.3f}</span><span class="s1">. MSE Test: </span><span class="si">{:.3f}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mse_train</span><span class="p">,</span> <span class="n">mse_test</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>MSE Train: 331.064. MSE Test: 249.849
MSE Train: 112.057. MSE Test: 30.751
MSE Train: 84.952. MSE Test: 3.536
</pre>
</div>
</div>

</div>
</div>

</div>
    

</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="goodboychan/chans_jupyter"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/chans_jupyter/python/datacamp/kaggle/machine_learning/2020/08/12/01-Kaggle-competitions-process.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/chans_jupyter/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/chans_jupyter/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/chans_jupyter/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>An easy to use blogging platform with support for Jupyter Notebooks.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/goodboychan" title="goodboychan"><svg class="svg-icon grey"><use xlink:href="/chans_jupyter/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://www.linkedin.com/in/chanseokk" title="chanseokk"><svg class="svg-icon grey"><use xlink:href="/chans_jupyter/assets/minima-social-icons.svg#linkedin"></use></svg></a></li><li><a rel="me" href="https://twitter.com/fastdotai" title="fastdotai"><svg class="svg-icon grey"><use xlink:href="/chans_jupyter/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
