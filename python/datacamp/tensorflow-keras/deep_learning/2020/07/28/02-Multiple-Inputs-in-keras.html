<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Multiple Inputs in Keras | Chan`s Jupyter</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Multiple Inputs in Keras" />
<meta name="author" content="Chanseok Kang" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In this chapter, you will extend your 2-input model to 3 inputs, and learn how to use Keras’ summary and plot functions to understand the parameters and topology of your neural networks. By the end of the chapter, you will understand how to extend a 2-input model to 3 inputs and beyond.This is the Summary of lecture “Advanced Deep Learning with Keras”, via datacamp." />
<meta property="og:description" content="In this chapter, you will extend your 2-input model to 3 inputs, and learn how to use Keras’ summary and plot functions to understand the parameters and topology of your neural networks. By the end of the chapter, you will understand how to extend a 2-input model to 3 inputs and beyond.This is the Summary of lecture “Advanced Deep Learning with Keras”, via datacamp." />
<link rel="canonical" href="https://goodboychan.github.io/python/datacamp/tensorflow-keras/deep_learning/2020/07/28/02-Multiple-Inputs-in-keras.html" />
<meta property="og:url" content="https://goodboychan.github.io/python/datacamp/tensorflow-keras/deep_learning/2020/07/28/02-Multiple-Inputs-in-keras.html" />
<meta property="og:site_name" content="Chan`s Jupyter" />
<meta property="og:image" content="https://goodboychan.github.io/images/team_strength_model.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-07-28T00:00:00-05:00" />
<script type="application/ld+json">
{"description":"In this chapter, you will extend your 2-input model to 3 inputs, and learn how to use Keras’ summary and plot functions to understand the parameters and topology of your neural networks. By the end of the chapter, you will understand how to extend a 2-input model to 3 inputs and beyond.This is the Summary of lecture “Advanced Deep Learning with Keras”, via datacamp.","url":"https://goodboychan.github.io/python/datacamp/tensorflow-keras/deep_learning/2020/07/28/02-Multiple-Inputs-in-keras.html","@type":"BlogPosting","headline":"Multiple Inputs in Keras","dateModified":"2020-07-28T00:00:00-05:00","datePublished":"2020-07-28T00:00:00-05:00","author":{"@type":"Person","name":"Chanseok Kang"},"image":"https://goodboychan.github.io/images/team_strength_model.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://goodboychan.github.io/python/datacamp/tensorflow-keras/deep_learning/2020/07/28/02-Multiple-Inputs-in-keras.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://goodboychan.github.io/feed.xml" title="Chan`s Jupyter" /><!-- the google_analytics_id gets auto inserted from the config file -->



<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-33905785-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-33905785-1');
</script>

<link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>

<script data-ad-client="ca-pub-6747875619665490" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script></head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Chan`s Jupyter</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About Me</a><a class="page-link" href="/book/">Book</a><a class="page-link" href="/search/">Search</a><a class="page-link" href="/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Multiple Inputs in Keras</h1><p class="page-description">In this chapter, you will extend your 2-input model to 3 inputs, and learn how to use Keras' summary and plot functions to understand the parameters and topology of your neural networks. By the end of the chapter, you will understand how to extend a 2-input model to 3 inputs and beyond.This is the Summary of lecture "Advanced Deep Learning with Keras", via datacamp.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-07-28T00:00:00-05:00" itemprop="datePublished">
        Jul 28, 2020
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Chanseok Kang</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      6 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/categories/#Python">Python</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#Datacamp">Datacamp</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#Tensorflow-Keras">Tensorflow-Keras</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#Deep_Learning">Deep_Learning</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/goodboychan/goodboychan.github.io/tree/main/_notebooks/2020-07-28-02-Multiple-Inputs-in-keras.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/goodboychan/goodboychan.github.io/main?filepath=_notebooks%2F2020-07-28-02-Multiple-Inputs-in-keras.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/goodboychan/goodboychan.github.io/blob/main/_notebooks/2020-07-28-02-Multiple-Inputs-in-keras.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>

        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#Three-input-models">Three-input models </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Make-an-input-layer-for-home-vs.-away">Make an input layer for home vs. away </a></li>
<li class="toc-entry toc-h3"><a href="#Make-a-model-and-compile-it">Make a model and compile it </a></li>
<li class="toc-entry toc-h3"><a href="#Fit-the-model-and-evaluate">Fit the model and evaluate </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Summarizing-and-plotting-models">Summarizing and plotting models </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Model-summaries">Model summaries </a></li>
<li class="toc-entry toc-h3"><a href="#Plotting-models">Plotting models </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Stacking-models">Stacking models </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Add-the-model-predictions-to-the-tournament-data">Add the model predictions to the tournament data </a></li>
<li class="toc-entry toc-h3"><a href="#Create-an-input-layer-with-multiple-columns">Create an input layer with multiple columns </a></li>
<li class="toc-entry toc-h3"><a href="#Fit-the-model">Fit the model </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Evaluate-the-model">Evaluate the model </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-07-28-02-Multiple-Inputs-in-keras.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">'figure.figsize'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Three-input-models">
<a class="anchor" href="#Three-input-models" aria-hidden="true"><span class="octicon octicon-link"></span></a>Three-input models<a class="anchor-link" href="#Three-input-models"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Make-an-input-layer-for-home-vs.-away">
<a class="anchor" href="#Make-an-input-layer-for-home-vs.-away" aria-hidden="true"><span class="octicon octicon-link"></span></a>Make an input layer for home vs. away<a class="anchor-link" href="#Make-an-input-layer-for-home-vs.-away"> </a>
</h3>
<p>Now you will make an improvement to the model you used in the previous chapter for regular season games. You know there is a well-documented home-team advantage in basketball, so you will add a new input to your model to capture this effect.</p>
<p>This model will have three inputs: team_id_1, team_id_2, and home. The team IDs will be integers that you look up in your team strength model from the previous chapter, and home will be a binary variable, 1 if team_1 is playing at home, 0 if they are not.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">games_season</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'./dataset/games_season.csv'</span><span class="p">)</span>
<span class="n">games_season</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>season</th>
      <th>team_1</th>
      <th>team_2</th>
      <th>home</th>
      <th>score_diff</th>
      <th>score_1</th>
      <th>score_2</th>
      <th>won</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1985</td>
      <td>3745</td>
      <td>6664</td>
      <td>0</td>
      <td>17</td>
      <td>81</td>
      <td>64</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1985</td>
      <td>126</td>
      <td>7493</td>
      <td>1</td>
      <td>7</td>
      <td>77</td>
      <td>70</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1985</td>
      <td>288</td>
      <td>3593</td>
      <td>1</td>
      <td>7</td>
      <td>63</td>
      <td>56</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1985</td>
      <td>1846</td>
      <td>9881</td>
      <td>1</td>
      <td>16</td>
      <td>70</td>
      <td>54</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1985</td>
      <td>2675</td>
      <td>10298</td>
      <td>1</td>
      <td>12</td>
      <td>86</td>
      <td>74</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">games_tourney</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'./dataset/games_tourney.csv'</span><span class="p">)</span>
<span class="n">games_tourney</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>season</th>
      <th>team_1</th>
      <th>team_2</th>
      <th>home</th>
      <th>seed_diff</th>
      <th>score_diff</th>
      <th>score_1</th>
      <th>score_2</th>
      <th>won</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1985</td>
      <td>288</td>
      <td>73</td>
      <td>0</td>
      <td>-3</td>
      <td>-9</td>
      <td>41</td>
      <td>50</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1985</td>
      <td>5929</td>
      <td>73</td>
      <td>0</td>
      <td>4</td>
      <td>6</td>
      <td>61</td>
      <td>55</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1985</td>
      <td>9884</td>
      <td>73</td>
      <td>0</td>
      <td>5</td>
      <td>-4</td>
      <td>59</td>
      <td>63</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1985</td>
      <td>73</td>
      <td>288</td>
      <td>0</td>
      <td>3</td>
      <td>9</td>
      <td>50</td>
      <td>41</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1985</td>
      <td>3920</td>
      <td>410</td>
      <td>0</td>
      <td>1</td>
      <td>-9</td>
      <td>54</td>
      <td>63</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Embedding</span><span class="p">,</span> <span class="n">Input</span><span class="p">,</span> <span class="n">Flatten</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Model</span>

<span class="c1"># Count the unique number of teams</span>
<span class="n">n_teams</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">games_season</span><span class="p">[</span><span class="s1">'team_1'</span><span class="p">])</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Create an embedding layer</span>
<span class="n">team_lookup</span> <span class="o">=</span> <span class="n">Embedding</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="n">n_teams</span><span class="p">,</span>
                        <span class="n">output_dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                        <span class="n">input_length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                        <span class="n">name</span><span class="o">=</span><span class="s1">'Team-Strength'</span><span class="p">)</span>

<span class="c1"># Create an input layer for the team ID</span>
<span class="n">teamid_in</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">))</span>

<span class="c1"># Lookup the input in the team strength embedding layer</span>
<span class="n">strength_lookup</span> <span class="o">=</span> <span class="n">team_lookup</span><span class="p">(</span><span class="n">teamid_in</span><span class="p">)</span>

<span class="c1"># Flatten the output</span>
<span class="n">strength_lookup_flat</span> <span class="o">=</span> <span class="n">Flatten</span><span class="p">()(</span><span class="n">strength_lookup</span><span class="p">)</span>

<span class="c1"># Combine the operations into a single, re-usable model</span>
<span class="n">team_strength_model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">teamid_in</span><span class="p">,</span> <span class="n">strength_lookup_flat</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'Team-Strength-Model'</span><span class="p">)</span>

<span class="n">team_strength_model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Model: "Team-Strength-Model"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 1)]               0         
_________________________________________________________________
Team-Strength (Embedding)    (None, 1, 1)              10888     
_________________________________________________________________
flatten (Flatten)            (None, 1)                 0         
=================================================================
Total params: 10,888
Trainable params: 10,888
Non-trainable params: 0
_________________________________________________________________
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Concatenate</span><span class="p">,</span> <span class="n">Dense</span>

<span class="c1"># Create an Input for each team</span>
<span class="n">team_in_1</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">'Team-1-In'</span><span class="p">)</span>
<span class="n">team_in_2</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">'Team-2-In'</span><span class="p">)</span>

<span class="c1"># Create an input for home vs away</span>
<span class="n">home_in</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">'Home-In'</span><span class="p">)</span>

<span class="c1"># Lookup the team inputs in the team strength model</span>
<span class="n">team_1_strength</span> <span class="o">=</span> <span class="n">team_strength_model</span><span class="p">(</span><span class="n">team_in_1</span><span class="p">)</span>
<span class="n">team_2_strength</span> <span class="o">=</span> <span class="n">team_strength_model</span><span class="p">(</span><span class="n">team_in_2</span><span class="p">)</span>

<span class="c1"># Combine the team strengths with the home input using a Concatenate layer, </span>
<span class="c1"># then add a Dense layer</span>

<span class="n">out</span> <span class="o">=</span> <span class="n">Concatenate</span><span class="p">()([</span><span class="n">team_1_strength</span><span class="p">,</span> <span class="n">team_2_strength</span><span class="p">,</span> <span class="n">home_in</span><span class="p">])</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">)(</span><span class="n">out</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Make-a-model-and-compile-it">
<a class="anchor" href="#Make-a-model-and-compile-it" aria-hidden="true"><span class="octicon octicon-link"></span></a>Make a model and compile it<a class="anchor-link" href="#Make-a-model-and-compile-it"> </a>
</h3>
<p>Now that you've input and output layers for the 3-input model, wrap them up in a Keras model class, and then compile the model, so you can fit it to data and use it to make predictions on new data.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">([</span><span class="n">team_in_1</span><span class="p">,</span> <span class="n">team_in_2</span><span class="p">,</span> <span class="n">home_in</span><span class="p">],</span> <span class="n">out</span><span class="p">)</span>

<span class="c1"># Compile the model</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">'adam'</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">'mean_absolute_error'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Fit-the-model-and-evaluate">
<a class="anchor" href="#Fit-the-model-and-evaluate" aria-hidden="true"><span class="octicon octicon-link"></span></a>Fit the model and evaluate<a class="anchor-link" href="#Fit-the-model-and-evaluate"> </a>
</h3>
<p>Now that you've defined a new model, fit it to the regular season basketball data.</p>
<p>Use the <code>model</code> you fit in the previous exercise (which was trained on the regular season data) and evaluate the model on data for tournament games (<code>games_tourney</code>).</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">([</span><span class="n">games_season</span><span class="p">[</span><span class="s1">'team_1'</span><span class="p">],</span> <span class="n">games_season</span><span class="p">[</span><span class="s1">'team_2'</span><span class="p">],</span> <span class="n">games_season</span><span class="p">[</span><span class="s1">'home'</span><span class="p">]],</span>
          <span class="n">games_season</span><span class="p">[</span><span class="s1">'score_diff'</span><span class="p">],</span>
          <span class="n">epochs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">validation_split</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">2048</span><span class="p">)</span>

<span class="c1"># Evaluate the model on the games_touney dataset</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">([</span><span class="n">games_tourney</span><span class="p">[</span><span class="s1">'team_1'</span><span class="p">],</span> <span class="n">games_tourney</span><span class="p">[</span><span class="s1">'team_2'</span><span class="p">],</span> <span class="n">games_tourney</span><span class="p">[</span><span class="s1">'home'</span><span class="p">]],</span> 
                      <span class="n">games_tourney</span><span class="p">[</span><span class="s1">'score_diff'</span><span class="p">],</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>138/138 [==============================] - 0s 2ms/step - loss: 12.2876 - val_loss: 11.5519
11.686502456665039
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Summarizing-and-plotting-models">
<a class="anchor" href="#Summarizing-and-plotting-models" aria-hidden="true"><span class="octicon octicon-link"></span></a>Summarizing and plotting models<a class="anchor-link" href="#Summarizing-and-plotting-models"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Model-summaries">
<a class="anchor" href="#Model-summaries" aria-hidden="true"><span class="octicon octicon-link"></span></a>Model summaries<a class="anchor-link" href="#Model-summaries"> </a>
</h3>
<p>In this exercise, you will take a closer look at the summary of one of your 3-input models available in your workspace as model. Note how many layers the model has, how many parameters it has, and how many of those parameters are trainable/non-trainable.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Model: "model"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
Team-1-In (InputLayer)          [(None, 1)]          0                                            
__________________________________________________________________________________________________
Team-2-In (InputLayer)          [(None, 1)]          0                                            
__________________________________________________________________________________________________
Team-Strength-Model (Model)     (None, 1)            10888       Team-1-In[0][0]                  
                                                                 Team-2-In[0][0]                  
__________________________________________________________________________________________________
Home-In (InputLayer)            [(None, 1)]          0                                            
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 3)            0           Team-Strength-Model[1][0]        
                                                                 Team-Strength-Model[2][0]        
                                                                 Home-In[0][0]                    
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            4           concatenate[0][0]                
==================================================================================================
Total params: 10,892
Trainable params: 10,892
Non-trainable params: 0
__________________________________________________________________________________________________
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Plotting-models">
<a class="anchor" href="#Plotting-models" aria-hidden="true"><span class="octicon octicon-link"></span></a>Plotting models<a class="anchor-link" href="#Plotting-models"> </a>
</h3>
<p>In addition to summarizing your model, you can also plot your model to get a more intuitive sense of it.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">tensorflow.keras.utils</span> <span class="kn">import</span> <span class="n">plot_model</span>

<span class="c1"># Plot model</span>
<span class="n">plot_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">to_file</span><span class="o">=</span><span class="s1">'../images/team_strength_model.png'</span><span class="p">)</span>

<span class="c1"># Display the image</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">'../images/team_strength_model.png'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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UVERevfujQ0bNuDMmTNYtmwZgoODPYql7jKbs25bskxqI+52o9v6xUPZ1J55cihbVfXEiRPat29ftVgsOmXKFN23b5/bcRMmTNBNmzapqmpubq7jcOPChQtVVd0etvztb3+rffv21ejoaJe6S0tLNS4uTi0Wi86YMUMXLFigABznb/fu3auJiYkaFxenzz//vKO+uXPnar9+/TQyMlLHjx/vKG8snkmTJnm8zODgYI+XqaqamJjY6Dlmu7vvvtux7BEjRujSpUsbXAehoaFu+9ner87D9rY1tA6d29yjRw+P+7msrEz79eunFotFx48frzk5OR7F05J129AyG8ND2d6BBg5lizodYjJKQkKC5uXlGR0G0UXJzMxERkYGzPBZIvKGzMxMpKenGx2GzxGRfFVNqFvOQ9lEREQmwsRMRERkIkzMREREJsLETEREZCJMzERERCbCxExERGQiTMxEREQmwsRMRERkIkzMREREJtJkYhaROBHZLCJ7RGSXiMyxlS8SkSMiUmh73eo0zyMisl9EikRkgjcbQERE5EsCPJimGsDvVfUrEekKIF9EcmzjnlXVp50nFpGrAEwBMBBADICNIjJAVWtaM3AiIiJf1GRiVtUSACW292dFZA+A2EZmSQKwSlXPA/hWRPYDGA4gtxXiJTItd4/2I/IVvFd22/Fkj9lBRPoAuAbAFwBGAnhARKYByIN1r/oUrEn7c6fZitF4Iidq166//nqsXr3a6DA6lIyMDPY5+SyPny4lIiEAtgB4QlXfFpEeAE7A+hiyPwKIVtX/IyLPA8hV1Tds870MIFtV36pT30wAMwGgV69eQw8dOtRabSIiHycifJoXtXsterqUiFgAvAVgpaq+DQCq+r2q1qhqLYAVsB6uBqx7yHFOs/cEcLRunaq6XFUTVDUhMjKyea0hIiLyUZ5clS0AXgawR1X/4lQe7TTZLwDstL1/D8AUEQkUkb4A+gP4svVCJiIi8l2enGMeCeBuAF+LSKGt7FEAvxSRIbAeyj4IYBYAqOouEckEsBvWK7rv5xXZREREnvHkquytANxdbprdyDxPAHiiBXERERF1SLzzFxERkYkwMRMREZkIEzMREZGJMDETERGZCBMzERGRiTAxExERmQgTMxERkYkwMRMREZkIEzMREZGJMDETERGZCBMzERGRiTAxExERmQgTMxERkYkwMRMREZkIEzMREZGJMDETERGZCBMzERGRiQQYHQARUVOqqqpQXl7uUnbq1CnH+/Dw8LYOichrmJiJyPTKysrQs2dP1NTUOMq6d+/ueK+qRoRF5BU8lE1EphcVFYUVK1a4Hefv79/G0RB5FxMzEbULd9xxR70yf39/TJw40YBoiLyHiZmI2oVu3bohIMD17Juq4q677jIoIiLvYGImonYjMDDQZTgjIwNTpkwxKBoi72BiJqJ2IyUlBRaLxTE8depUA6Mh8g4mZiJqN1555RV07doVAGCxWDBp0iSDIyJqfUzMRNRuBAQEOA5dV1VVGRwNkXc0mZhFpLOIfCki20Vkl4j8wVbeV0S+EJFvRGS1iHSylQfahvfbxvfxbhOIqCN57rnnAAAPPfSQwZEQeYcnNxg5D2CsqpaLiAXAVhHZAGAugGdVdZWIvAjgHgB/t/09pao/E5EpAJ4EkOGl+InIQ2lpaUaH0KoKCgp8pk3XXXcd5s6da3QYZBJNJma13lLHfi88i+2lAMYCuNNW/hqARbAm5iTbewBYA+A5ERHlrXmIDJWWlob09HSjw2gVmZmZPtOWtLQ05ObmGh0GmYhH55hFxF9ECgEcB5AD4ACA06pabZukGECs7X0sgMMAYBt/BkCEmzpnikieiOSVlpa2rBVE1KH4SlImcsejxKyqNao6BEBPAMMBXOluMttfaWScc53LVTVBVRMiIyM9jZeIiMinNeuqbFU9DeBjACMAhImI/VB4TwBHbe+LAcQBgG18KICTrREsERGRr/PkquxIEQmzvQ8CcBOAPQA2A0i1TTYdwLu29+/ZhmEb/xHPLxMREXnGk6uyowG8JiL+sCbyTFVdLyK7AawSkcUACgC8bJv+ZQD/KyL7Yd1T5v3yiIiIPOTJVdk7AFzjpvw/sJ5vrlteCcA3fsNARETUxnjnLyIiIhNhYiYiIjIRJmYiIiITYWImonpWrVoFEUHnzp2NDsUjIuJ4+fn5ITw8HLNnz0Z+fr7RoRE1GxMzEdUzZcoUtKdfORYUFAAAVBW1tbU4deoUXnjhBWRmZiIpKaldtYWIiZmIfNaSJUvw3nvvYdWqVUaHQuQxJmYi8lki1jsEv/DCCwZHQuQ5JmYiAgDs378fPXv2RE5ODr7++mtMmDDBZXxJSQn69OmD7OxslJeXY8yYMQgKCnKMT05OhoggOTkZFRUV2LhxI4YP/+lWB/fddx9ycnJw7tw5zJs3DyKCjz/+2FF3VFQUsrOzsWvXLowZM8bliUtjx45FRES9Z+F4bOvWrfWW01gbcnNzUVFRgS5dujTZBrs+ffo02gYij6mq4a+hQ4cqEXnX6tWrGx2flpama9ascQwfOXJEAwMDHcPTp09X61eGVUlJicv4pKQkBaDr1q1zlAHQ0tJSVVXt27evy/IGDBigmzdvdtS9cuVKl7qdvxdGjx6t4eHhDcZeUFDgEpszWB+i0+By3LXBLjU1tck2OC+nsTY0JDU1VVNTU5ucjnwPgDx1kxMNT8rKxEzUJhpLzJWVlW4Tmz1p2ce7e3300Ueq+lNSO3funGN+AFpQUKCqqrW1tTpu3Djt0qWLTpgwQd9++22P625KU4n5hhtuaFYb7ObPn+/1NjAxd1wNJWYeyiYiBAYGomvXrigvL29wfFhYGAICAup9idx4440eLUNEsHHjRpw+fRqqipSUFPzlL39x1F1VVXXRdTektrYWAHD//fe3ynLctQGw9k9AQIBX2kAdDxMzEQGw/uToiiuuQE5ODnbv3o2JEye6jC8qKkLv3r2xYcMGnDlzBsuWLUNwcLDH9YeFhWHHjh2ora3F9ddfDwA4d+6co+7LL78cGzZswMmTJ7Fs2TJkZmY65m3OOeba2locP34c48aNg7+/P3788Uekp6fXW05rtcGud+/ejbaByGPudqPb+sVD2UTe19Q5ZlXV5ORk7datmw4bNkzXr1/vcn5WVbWsrEz79eunFotFx48frzk5Oaqqmpub63L4VlXrDRcWFuqVV16pXbp00REjRuiKFSu0trbWUffcuXO1X79+GhkZqePHj3eJKzExsdFzzM7LEhENDQ3VX//615qfn19vWvtyGmvDwoULPW6Dc9801oaG8FB2x4UGDmWLdZyxEhISNC8vz+gwiHxaZmamY8+RzCMtzfowvqysLIMjobYmIvmqmlC3nIeyiYiITISJmYiIyESYmImIiEyEiZmIiMhEmJiJiIhMhImZiIjIRJiYiYiITISJmYiIyESYmImIiEyEiZmIiMhEmJiJiIhMJKCpCUSkM4BPAATapl+jqo+LyKsARgM4Y5t0hqoWiogAWArgVgA/2sq/8kbwROS5Z599lvdjNqHPP/8cI0aMMDoMMpEmEzOA8wDGqmq5iFgAbBWRDbZx81R1TZ3pbwHQ3/a6FsDfbX+JyEA9e/Y0OgRyY8SIEbjuuuuMDoNMpMnEbHs0lf3p6Rbbq7FHUiUBeN023+ciEiYi0apa0uJoieiicW+ZqH3w6ByziPiLSCGA4wByVPUL26gnRGSHiDwrIoG2slgAh51mL7aVERERURM8SsyqWqOqQwD0BDBcRAYBeATAFQCGAegOYL5tcnFXRd0CEZkpInkikldaWnpRwRMREfkaT84xO6jqaRH5GMBEVX3aVnxeRP4B4CHbcDGAOKfZegI46qau5QCWA4CIlIpIBYATzQvfp10C9kdd7JP62Cf1sU9csT/qM0uf9HZX6MlV2ZEAqmxJOQjATQCetJ83tl2FnQxgp22W9wA8ICKrYL3o60xT55dVNVJE8lQ1oRkN8mnsj/rYJ/WxT+pjn7hif9Rn9j7xZI85GsBrIuIP66HvTFVdLyIf2ZK2ACgE8F+26bNh/anUflh/LvWr1g+biIjIN3lyVfYOANe4KR/bwPQK4P6Wh0ZERNTxmOnOX8uNDsBk2B/1sU/qY5/Uxz5xxf6oz9R9ItYdXCIiIjIDM+0xExERdXiGJ2YRmSgiRSKyX0QWGB1PWxGRV0TkuIjsdCrrLiI5IvKN7W+4rVxE5G+2PtohIj83LnLvEJE4EdksIntEZJeIzLGVd+Q+6SwiX4rIdluf/MFW3ldEvrD1yWoR6WQrD7QN77eN72Nk/N5ku+lRgYistw136D4RkYMi8rWIFIpInq2sw352AMB218k1IrLX9r1yXXvpE0MTs+1K7+dhvb/2VQB+KSJXGRlTG3oVwMQ6ZQsAbFLV/gA22YYB1/uPz4T1/uO+phrA71X1SgAjANxv2xY6cp/Y71MfD2AIgIkiMgLAkwCetfXJKQD32Ka/B8ApVf0ZgGdt0/mqOQD2OA2zT4AbVXWI08+AOvJnB7A+TOkDVb0CQDys20v76BNVNewF4DoAHzoNPwLgESNjauP29wGw02m4CEC07X00gCLb+2UAfuluOl99AXgXwM3sE0f7ugD4CtZ7A5wAEGArd3yGAHwI4Drb+wDbdGJ07F7oi56wfqmOBbAe1p9sdvQ+OQjgkjplHfazA6AbgG/rruv20idGH8rmfbVd9VDbzVhsfy+1lXeofrIdbrwGwBfo4H0ide5TD+AAgNOqWm2bxLndjj6xjT8DIKJtI24TfwXwMIBa23AE2CcK4F8iki8iM21lHfmz0w9AKYB/2E55vCQiwWgnfWJ0YvbovtrUcfpJREIAvAXgt6r6Q2OTuinzuT7ROvepB3Clu8lsf32+T0RkMoDjqprvXOxm0g7TJzYjVfXnsB6SvV9Ebmhk2o7QJwEAfg7g76p6DYAK/HTY2h1T9YnRidmj+2p3IN+LSDQA2P4et5V3iH4S6/O+3wKwUlXfthV36D6xU9XTAD6G9fx7mIjYbw7k3G5Hn9jGhwI42baRet1IALeLyEEAq2A9nP1XdOw+gaoetf09DuAdWP+J68ifnWIAxfrTkxDXwJqo20WfGJ2YtwHob7uishOAKbDea7ujeg/AdNv76bCeZ7WXT7NdOTgCHtx/vL0REQHwMoA9qvoXp1EduU8iRSTM9t5+n/o9ADYDSLVNVrdP7H2VCuAjtZ0w8xWq+oiq9lTVPrB+X3ykqlPRgftERIJFpKv9PYDxsD67oMN+dlT1GIDDInK5rWgcgN1oL31igpP0twLYB+u5s4VGx9OG7X4TQAmAKlj/W7sH1nNfmwB8Y/vb3TatwHr1+gEAXwNIMDp+L/THKFgPHe2A9d7rhbZtoyP3ydUACmx9shPA/7WV9wPwJaz3o88CEGgr72wb3m8b38/oNni5f8YAWN/R+8TW9u221y7792hH/uzY2jkEQJ7t87MWQHh76RPe+YuIiMhEjD6UTURERE6YmImIiEyEiZmIiMhEmJiJiIhMhImZiIjIRJiYiYiITISJmYiIyESYmImIiEzk/weiKzUujhQX6AAAAABJRU5ErkJggg==%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Stacking-models">
<a class="anchor" href="#Stacking-models" aria-hidden="true"><span class="octicon octicon-link"></span></a>Stacking models<a class="anchor-link" href="#Stacking-models"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Add-the-model-predictions-to-the-tournament-data">
<a class="anchor" href="#Add-the-model-predictions-to-the-tournament-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Add the model predictions to the tournament data<a class="anchor-link" href="#Add-the-model-predictions-to-the-tournament-data"> </a>
</h3>
<p>In lesson 1 of this chapter, you used the regular season model to make predictions on the tournament dataset, and got pretty good results! Try to improve your predictions for the tournament by modeling it specifically.</p>
<p>You'll use the prediction from the regular season model as an input to the tournament model. This is a form of "model stacking."</p>
<p>To start, take the regular season model from the previous lesson, and predict on the tournament data. Add this prediction to the tournament data as a new column.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">games_tourney</span><span class="p">[</span><span class="s1">'pred'</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="n">games_tourney</span><span class="p">[</span><span class="s1">'team_1'</span><span class="p">],</span> 
                                       <span class="n">games_tourney</span><span class="p">[</span><span class="s1">'team_2'</span><span class="p">],</span> 
                                       <span class="n">games_tourney</span><span class="p">[</span><span class="s1">'home'</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Create-an-input-layer-with-multiple-columns">
<a class="anchor" href="#Create-an-input-layer-with-multiple-columns" aria-hidden="true"><span class="octicon octicon-link"></span></a>Create an input layer with multiple columns<a class="anchor-link" href="#Create-an-input-layer-with-multiple-columns"> </a>
</h3>
<p>In this exercise, you will look at a different way to create models with multiple inputs. This method only works for purely numeric data, but its a much simpler approach to making multi-variate neural networks.</p>
<p>Now you have three numeric columns in the tournament dataset: <code>'seed_diff'</code>, <code>'home'</code>, and <code>'pred'</code>. In this exercise, you will create a neural network that uses a single input layer to process all three of these numeric inputs.</p>
<p>This model should have a single output to predict the tournament game score difference.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">input_tensor</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">))</span>

<span class="c1"># Pass it to a Dense layer with 1 unit</span>
<span class="n">output_tensor</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">)(</span><span class="n">input_tensor</span><span class="p">)</span>

<span class="c1"># Create a model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">input_tensor</span><span class="p">,</span> <span class="n">output_tensor</span><span class="p">)</span>

<span class="c1"># Compile the model</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">'adam'</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">'mean_absolute_error'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Fit-the-model">
<a class="anchor" href="#Fit-the-model" aria-hidden="true"><span class="octicon octicon-link"></span></a>Fit the model<a class="anchor-link" href="#Fit-the-model"> </a>
</h3>
<p>Now that you've enriched the tournament dataset and built a model to make use of the new data, fit that model to the tournament data.</p>
<p>Note that this <code>model</code> has only one input layer that is capable of handling all 3 inputs, so it's inputs and outputs do not need to be a list.</p>
<p>Tournament games are split into a training set and a test set. The tournament games before 2010 are in the training set, and the ones after 2010 are in the test set.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">games_tourney_train</span> <span class="o">=</span> <span class="n">games_tourney</span><span class="p">[</span><span class="n">games_tourney</span><span class="p">[</span><span class="s1">'season'</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">2010</span><span class="p">]</span>
<span class="n">games_tourney_test</span> <span class="o">=</span> <span class="n">games_tourney</span><span class="p">[</span><span class="n">games_tourney</span><span class="p">[</span><span class="s1">'season'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">2010</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">games_tourney_train</span><span class="p">[[</span><span class="s1">'home'</span><span class="p">,</span> <span class="s1">'seed_diff'</span><span class="p">,</span> <span class="s1">'pred'</span><span class="p">]],</span>
          <span class="n">games_tourney_train</span><span class="p">[</span><span class="s1">'score_diff'</span><span class="p">],</span>
          <span class="n">epochs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
          <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>103/103 [==============================] - 0s 715us/step - loss: 9.2063
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Evaluate-the-model">
<a class="anchor" href="#Evaluate-the-model" aria-hidden="true"><span class="octicon octicon-link"></span></a>Evaluate the model<a class="anchor-link" href="#Evaluate-the-model"> </a>
</h2>
<p>Now that you've fit your model to the tournament training data, evaluate it on the tournament test data. Recall that the tournament test data contains games from after 2010.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">games_tourney_test</span><span class="p">[[</span><span class="s1">'home'</span><span class="p">,</span> <span class="s1">'seed_diff'</span><span class="p">,</span> <span class="s1">'pred'</span><span class="p">]],</span>
                     <span class="n">games_tourney_test</span><span class="p">[</span><span class="s1">'score_diff'</span><span class="p">],</span>
                     <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>30/30 [==============================] - 0s 763us/step - loss: 9.1752
9.175172805786133
</pre>
</div>
</div>

</div>
</div>

</div>
    

</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="goodboychan/goodboychan.github.io"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/python/datacamp/tensorflow-keras/deep_learning/2020/07/28/02-Multiple-Inputs-in-keras.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>An easy to use blogging platform with support for Jupyter Notebooks.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/goodboychan" title="goodboychan"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://www.linkedin.com/in/chanseokk" title="chanseokk"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg></a></li><li><a rel="me" href="https://twitter.com/fastdotai" title="fastdotai"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
